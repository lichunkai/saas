webpackJsonp([63],{282:function(a,t,e){"use strict";function i(a){c||e(746)}Object.defineProperty(t,"__esModule",{value:!0});var n=e(517),s=e.n(n);for(var r in n)"default"!==r&&function(a){e.d(t,a,function(){return n[a]})}(r);var l=e(748),o=e.n(l),c=!1,h=e(0),d=i,u=h(s.a,o.a,!1,d,"data-v-47c6f990",null);u.options.__file="src/views/check-work/time-paiban.vue",t.default=u.exports},517:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"timePaiban",data:function(){var a=this;return{riqi:"",paiban:!1,chushihua:!1,paibanSata:!1,curMonth:"",curDay:1,curDays:30,mendianValue:[],mendianData:[],columns:[{title:"门店名称",key:"d_show_name"},{title:"排班状态",key:"kq_tp_name",align:"center"},{title:"操作",key:"caozuo",align:"center",render:function(t,e){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){a.selDepart=e.row.d_id,a.getStaff(),a.paibanSata=!0}}},"排班"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){a.selTpl="",a.selDepart=e.row.d_id,a.chushihua=!0}}},"初始化")])}}],departlist:[],stafflist:[],kqtpllist:[],weekArr:[],searchkey:[],selDepart:"",selTpl:"",data:[],departchoose:[],staffpaiban:[],rowpaiban:[],chushihuaColumns:[{title:"选择目录",key:"kq_tp_name",align:"center",render:function(t,e){return t("div",{props:{type:"error",size:"small"},on:{click:function(){a.selTpl=e.row.kq_tp_id}}},e.row.kq_tp_name)}}],chushihuaData:[{date:"周六全勤",align:"center"},{date:"周六全勤",align:"center"}]}},created:function(){this.getIndex()},methods:{getIndex:function(){this.$http.get(api_param.apiurl+"oakaoqingsetting/getlist",{params:{d_id:this.searchkey},headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(a){200==a.data.code?(this.departlist=a.data.data.departlist,this.chushihuaData=a.data.data.kqtpllist,this.departchoose=a.data.data.departchoose,this.weekArr=a.data.data.weekArr,this.curMonth=a.data.data.curMonth,this.curDay=parseInt(a.data.data.curDay),this.curDays=parseInt(a.data.data.curDays)):401==a.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(a.data.message)},function(a){console.log(a)})},getStaff:function(){this.$http.post(api_param.apiurl+"oakaoqingsetting/getstaff",{d_id:this.selDepart},{emulateJSON:!0,headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(a){200==a.data.code?(this.stafflist=a.data.data.list,this.rowpaiban=a.data.data.rowpaiban,this.staffpaiban=a.data.data.staffpaiban):401==a.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(a.data.message)},function(a){console.log(a)})},searchChange:function(a,t){this.searchkey=a[a.length-1]},selPaiban:function(a){for(var t=this.rowpaiban[a],e=this.curDay-1;e<this.curDays;e++){this.staffpaiban[a][e];this.staffpaiban[a][e]=t+"_"+this.weekArr[e].val2}},chushihuaOk:function(){if(""==this.selTpl)return alert("请选择模板！"),void(this.chushihua=!0);this.$http.post(api_param.apiurl+"/oakaoqingsetting/update",{d_id:this.selDepart,kq_tp_id:this.selTpl},{emulateJSON:!0,headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(a){200==a.data.code?(this.chushihua=!1,this.$Message.success(a.data.message),this.getIndex()):401==a.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(a.data.message)},function(a){this.$Message.warning("设置失败")})},chushihuaCancel:function(){this.chushihua=!1},clearSearch:function(){this.searchkey="",this.getIndex()},paibanOk:function(){this.$http.post(api_param.apiurl+"/oakaoqingsetting/staffupdate",{staffpaiban:this.staffpaiban,d_id:this.selDepart},{emulateJSON:!0,headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(a){200==a.data.code?(this.$Message.success(a.data.message),this.stafflist=[],this.rowpaiban=[],this.staffpaiban=[],this.paibanSata=!1):401==a.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(a.data.message)},function(a){this.$Message.warning("设置失败")})},paibanCancel:function(){this.stafflist=[],this.rowpaiban=[],this.staffpaiban=[],this.paibanSata=!1}}}},746:function(a,t,e){var i=e(747);"string"==typeof i&&(i=[[a.i,i,""]]),i.locals&&(a.exports=i.locals);e(8)("2a73d3be",i,!1,{})},747:function(a,t,e){t=a.exports=e(7)(!1),t.push([a.i,"\n.paibanCancel[data-v-47c6f990]{\n    overflow-y: auto;\n    border: #e2e2e2 1px solid;\n}\n.chushihuaDiv[data-v-47c6f990] {\n    width: 100%;\n    text-align: center;\n    font-size: 14px;\n}\n.chushihuaDiv p[data-v-47c6f990] {\n    background: #7108ff;\n    color: #fff;\n    font-weight: 600;\n    line-height: 3;\n}\n.chushihuaDiv a[data-v-47c6f990] {\n    display: block;\n    line-height: 3;\n    border-top: 1px solid #dddee1;\n}\n.paiban .ivu-table th[data-v-47c6f990] {\n    height: 40px;\n    white-space: nowrap;\n    overflow: hidden;\n    background-color: #f8f8f9;\n    text-align: center !important;\n}\n\n/*排班*/\n.rolemainul[data-v-47c6f990],\n.rolemainul-list[data-v-47c6f990] {\n    border-bottom: none;\n}\n.rolemainul[data-v-47c6f990] {\n    margin-top: -1px;\n}\n.rolemainul .rolemain[data-v-47c6f990],\n.rolemainul-list .rolemain[data-v-47c6f990] {\n    border-radius: 3px;\n    -webkit-border-radius: 3px;\n    -moz-border-radius: 3px;\n    -o-border-radius: 3px;\n    display: -ms-flexbox;\n    display: flex;\n    width: 350%;\n    overflow: hidden;\n}\n.rolemainul .rolemain .rolemainlist[data-v-47c6f990],\n.rolemainul-list .rolemain .rolemainlist[data-v-47c6f990] {\n    -ms-flex: 1;\n        flex: 1;\n    height: 44px;\n    line-height: 44px;\n    border-bottom: #e2e2e2 1px solid;\n    border-right: #e2e2e2 1px solid;\n    overflow: hidden;\n    display: table-cell;\n    vertical-align: middle;\n    text-align: center;\n}\n.rolemainul .rolemain .rolemainlist .rolewidth[data-v-47c6f990] {\n    text-align: center;\n    margin: auto;\n}\n.rolemainul .rolemain .rolemainlist[data-v-47c6f990]:last-child {\n    border-right: none !important;\n}\n",""])},748:function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("Row",{staticClass:"paiban"},[e("Col",{attrs:{lg:24,md:24}},[e("Card",[e("Row",{attrs:{gutter:5}},[e("Col",{attrs:{lg:3,md:3}},[e("Cascader",{attrs:{data:a.departchoose,value:a.searchkey,filterable:"","change-on-select":"",placeholder:"门店",transfer:!0},on:{"update:value":function(t){a.searchkey=t},"on-change":a.searchChange}})],1),a._v(" "),e("Col",{attrs:{lg:3,md:3}},[e("Button",{attrs:{type:"primary"},on:{click:a.getIndex}},[a._v("查询")]),a._v(" "),e("Button",{attrs:{type:"primary"},on:{click:a.clearSearch}},[a._v("清空")])],1)],1)],1)],1),a._v(" "),e("Col",{staticStyle:{"margin-top":"10px"},attrs:{lg:24,md:24}},[e("Card",[e("Table",{attrs:{border:"",columns:a.columns,data:a.departlist}})],1)],1),a._v(" "),e("Modal",{attrs:{title:"初始化模块","mask-closable":!1},on:{"on-ok":a.chushihuaOk,"on-cancel":a.chushihuaCancel},model:{value:a.chushihua,callback:function(t){a.chushihua=t},expression:"chushihua"}},[e("Table",{attrs:{columns:a.chushihuaColumns,data:a.chushihuaData,"highlight-row":!0}})],1),a._v(" "),e("Modal",{attrs:{scrollable:"",title:a.curMonth+"排班",width:"960"},on:{"on-ok":a.paibanOk,"on-cancel":a.paibanCancel},model:{value:a.paibanSata,callback:function(t){a.paibanSata=t},expression:"paibanSata"}},[e("TabPane",{staticClass:"paibanCancel",attrs:{label:""}},[e("ul",{staticClass:"rolemainul-list"},[e("li",{staticClass:"rolemain"},[e("div",{staticClass:"rolemainlist"}),a._v(" "),e("div",{staticClass:"rolemainlist"}),a._v(" "),a._l(a.weekArr,function(t){return e("div",{staticClass:"rolemainlist"},[a._v("\n                        "+a._s(t.val1))])})],2)]),a._v(" "),e("ul",{staticClass:"rolemainul"},a._l(a.stafflist,function(t,i){return e("li",{staticClass:"rolemain"},[e("div",{staticClass:"rolemainlist"},[e("div",{staticClass:"rolewidth"},[a._v(a._s(t.u_name))])]),a._v(" "),e("div",{staticClass:"rolemainlist"},[e("div",{staticClass:"rolewidth"},[e("Select",{staticStyle:{width:"80px"},attrs:{size:"small",transfer:!0,placeholder:"请选择"},on:{"on-change":function(t){return a.selPaiban(i)}},model:{value:a.rowpaiban[i],callback:function(t){a.$set(a.rowpaiban,i,t)},expression:"rowpaiban[idx]"}},a._l(a.chushihuaData,function(i){return e("Option",{key:i.kq_tp_id,attrs:{value:t.u_id+"_"+i.kq_tp_id}},[a._v(a._s(i.kq_tp_name)+"\n                                ")])}),1)],1)]),a._v(" "),a._l(a.weekArr,function(n,s){return[e("div",{staticClass:"rolemainlist"},[e("div",{staticClass:"rolewidth"},[1==n.val0?[e("Select",{staticStyle:{width:"80px"},attrs:{md:n.val2,size:"small",transfer:!0,placeholder:"请选择",disabled:""},model:{value:a.staffpaiban[i][s],callback:function(t){a.$set(a.staffpaiban[i],s,t)},expression:"staffpaiban[idx][widx]"}},a._l(a.chushihuaData,function(i){return e("Option",{key:i.kq_tp_id,attrs:{value:t.u_id+"_"+i.kq_tp_id+"_"+n.val2}},[a._v(a._s(i.kq_tp_name)+"\n                                        ")])}),1)]:[e("Select",{staticStyle:{width:"80px"},attrs:{md:n.val2,size:"small",transfer:!0,placeholder:"请选择"},model:{value:a.staffpaiban[i][s],callback:function(t){a.$set(a.staffpaiban[i],s,t)},expression:"staffpaiban[idx][widx]"}},a._l(a.chushihuaData,function(i){return e("Option",{key:i.kq_tp_id,attrs:{value:t.u_id+"_"+i.kq_tp_id+"_"+n.val2}},[a._v(a._s(i.kq_tp_name)+"\n                                        ")])}),1)]],2)])]})],2)}),0)])],1)],1)},n=[];i._withStripped=!0;var s={render:i,staticRenderFns:n};t.default=s}});