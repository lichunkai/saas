webpackJsonp([31],{258:function(t,a,e){"use strict";function s(t){h||e(678)}Object.defineProperty(a,"__esModule",{value:!0});var i=e(493),n=e.n(i);for(var o in i)"default"!==o&&function(t){e.d(a,t,function(){return i[t]})}(o);var r=e(680),l=e.n(r),h=!1,c=e(0),u=s,d=c(n.a,l.a,!1,u,null,null);d.options.__file="src/views/ziyuanguanli/houseKey.vue",a.default=d.exports},493:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default={name:"houseKey",data:function(){var t=this;return{pageSize:10,jiechu:!1,shixiao:!1,daikan:"",genjin:"",page:1,pageCount:0,searchData:{departpath:[],villages:[]},settings:{},users:[],jiechu_users:[],jiechuData:{hk_jiechuyaoshiren:"",departpathss:[]},rizhi:!1,keylogColumns:[{title:"部门",key:"d_name",align:"center"},{title:"员工",key:"u_name",align:"center"},{title:"操作内容",key:"hkl_content",align:"center"},{title:"操作时间",key:"ctime",align:"center"}],totallog:0,currentpage:1,keylogdata:[],chColumns:[{title:"标签",key:"biaoqian",fixed:"left",width:128,align:"center",render:function(t,a){var e=[];return a.row.genjincishu&&e.push(t("Tag",{props:{color:"green"}},"跟("+a.row.genjincishu+")")),a.row.daikancishu&&e.push(t("Tag",{props:{color:"yellow"}},"带("+a.row.daikancishu+")")),t("div",e)}},{title:"房源类型",key:"sale_type",width:108,align:"center",render:function(t,a){var e="";return"1"==a.row.sale_type&&(e="出租"),"2"==a.row.sale_type&&(e="出售"),"3"==a.row.sale_type&&(e="高端"),t("div",{props:{}},e)}},{title:"钥匙状态",key:"hk_status_text",width:108,align:"center"},{title:"房源状态",key:"house_status_text",width:108,align:"center"},{title:"片区",key:"dts_name",width:108,align:"center"},{title:"小区",key:"village_name",width:128,align:"center"},{title:"座栋",key:"loudong_name",width:88,align:"center"},{title:"单元",key:"danyuan_name",width:88,align:"center"},{title:"房号",key:"fanghao_name",width:88,align:"center"},{title:"房源编号",key:"house_sn",align:"center",width:148,render:function(a,e){return a("div",[a("a",{props:{type:"warning",size:"small"},style:{textDecoration:"underline"},domProps:{innerHTML:e.row.house_sn},on:{click:function(){var a={houseId:e.row.house_uuid};t.$router.push({name:"roomDetails",params:a})}}})])}},{title:"收钥日期",key:"ctime",align:"center",width:148},{title:"带看日期",key:"daikanshijian",align:"center",width:148},{title:"维护人跟进日期",key:"weihurengenjin",align:"center",width:128},{title:"全员跟进日期",key:"quanyuangenjin",align:"center",width:128},{title:"钥匙所在店",key:"hk_dian_text",width:108,align:"center"},{title:"收钥匙人",key:"deyaoshiren_name",width:108,align:"center"},{title:"操作",key:"action",align:"center",width:148,fixed:"right",render:function(a,e){var s=[];return s.push(a("Button",{props:{type:"warning",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.lpage=1,t.hk_id=e.row.hk_id,t.rizhi=!0,t.keyLog()}}},"日志")),1==e.row.hk_status&&s.push(a("Button",{props:{type:"error",size:"small"},on:{click:function(){t.hk_id=e.row.hk_id,t.house_id=e.row.house_id,t.house_sn=e.row.house_sn,t.shixiao=!0}}},"失效")),2==e.row.hk_status&&(s.push(a("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.jiechuData.hk_id=e.row.hk_id,t.jiechuData.hk_status=1,t.jiechuData.hk_jiechuyaoshiren=e.row.hk_jiechuyaoshiren,t.$http.post(api_param.apiurl+"house_key/setstatus",t.jiechuData,{emulateJSON:!0,headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(t){200==t.data.code?(this.$Message.success(t.data.message),this.jiechu=!1,this.getIndex()):401==t.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(t.data.message)},function(t){this.$Message.error("网络异常")})}}},"归还")),s.push(a("Button",{props:{type:"error",size:"small"},on:{click:function(){t.hk_id=e.row.hk_id,t.house_id=e.row.house_id,t.house_sn=e.row.house_sn,t.shixiao=!0}}},"失效"))),a("div",s)}}],chData:[],jiechuValidate:{hk_jiechuyaoshiren:[{required:!0,message:"请选择借出人",trigger:"change"}]},hk_id:0,shixiaoValidate:{shixiaoyuanyin:[{required:!0,message:"请选择失效原因",trigger:"change"}],shixiaoBeizhu:[{required:!0,message:"请选择失效原因",trigger:"blur"}]},shixiaoData:{shixiaoyuanyin:"",shixiaoBeizhu:""},house_id:"",house_sn:""}},created:function(){this.getSetting(),this.getIndex()},methods:{paixu:function(t){this.searchData.paixu=t,this.pageCurrent=1,this.getIndex()},daikan_s:function(){this.genjin="",this.page=1,this.getIndex()},genjin_s:function(){this.daikan="",this.page=1,this.getIndex()},getSetting:function(){this.$http.get(api_param.apiurl+"house/getsetting",{params:{},headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(t){if(200==t.data.code)for(var a in t.data.data)this.$set(this.settings,a,t.data.data[a]);else 401==t.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(t.data.message)},function(t){this.$Message.error("你的网络开小差了^—^")})},getIndex:function(){this.searchData.page=this.page,this.searchData.daikan=this.daikan,this.searchData.genjin=this.genjin;this.$http.post(api_param.apiurl+"house_key/getindex",this.searchData,{emulateJSON:!0,headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(t){200==t.data.code?(this.chData=t.data.data.list,this.pageCount=parseInt(t.data.data.count),this.$Message.success("获取成功")):401==t.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(t.data.message)},function(t){this.$Message.error("网络异常")})},changeDepart:function(t,a){var e=t.pop();this.searchData.d_id=e,this.users=this.settings.users[e]},changeJiechuDepart:function(t,a){var e=t.pop();this.jiechu_users=this.settings.users[e]},selectDate:function(t){this.searchData.daterange=t},selectArea:function(t){this.mianji=t.split("-")},selectPrice:function(t){this.jiage=t.split("-")},doSearch:function(){this.page=1,this.getIndex()},doClear:function(){this.page=1,this.searchData.sale_type="",this.searchData.house_status="",this.searchData.hk_status="",this.searchData.departpath=[],this.searchData.u_id="",this.searchData.daterange="",this.searchData.villages=[],this.searchData.danyuan="",this.searchData.d_id="",this.users=[],this.daikan="",this.genjin="",this.getIndex()},keyLog:function(){this.$http.post(api_param.apiurl+"house_key/housekeylog",{page:this.currentpage,hk_id:this.hk_id},{emulateJSON:!0,headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(t){200==t.data.code?(this.totallog=parseInt(t.data.data.total),this.keylogdata=t.data.data.list):401==t.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(t.data.message)},function(t){this.$Message.error("网络异常")})},changelogPage:function(t){this.lpage=t,this.keyLog()},changePage:function(t){this.page=t,this.getIndex()},changePage22:function(t){this.currentpage=t,this.keyLog()},JiechuModalCancel:function(){this.jiechu=!1},JiechuModalOk:function(){var t=this;this.$refs.jiechuData.validate(function(a){a&&(t.jiechuData.hk_id=t.hk_id,t.jiechuData.hk_status=2,t.$http.post(api_param.apiurl+"house_key/setstatus",t.jiechuData,{emulateJSON:!0,headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(t){200==t.data.code?(this.$Message.success(t.data.message),this.jiechu=!1,this.getIndex()):401==t.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(t.data.message)},function(t){this.$Message.error("网络异常")}))})},shixiaoModalCancel:function(){this.shixiao=!1},shixiaoModalOk:function(){var t=this;this.$refs.shixiaoData.validate(function(a){a&&(t.shixiaoData.hk_id=t.hk_id,t.shixiaoData.hk_status=4,t.shixiaoData.house_id=t.house_id,t.shixiaoData.house_sn=t.house_sn,t.$http.post(api_param.apiurl+"house_key/shixiao",t.shixiaoData,{emulateJSON:!0,headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(t){200==t.data.code?(this.$Message.success(t.data.message),this.shixiao=!1,this.getIndex()):401==t.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(t.data.message)},function(t){this.$Message.error("网络异常")}))})}}}},678:function(t,a,e){var s=e(679);"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);e(8)("1e917416",s,!1,{})},679:function(t,a,e){a=t.exports=e(7)(!1),a.push([t.i,"\n.marTop10px {\n  margin-top: 10px;\n}\n.marTop10px .ivu-table-cell {\n  padding: 0 !important;\n}\n",""])},680:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Row",[e("Col",{attrs:{lg:24,md:24}},[e("Card",[e("Row",{attrs:{gutter:5}},[e("Col",{attrs:{lg:2,md:2}},[e("Select",{attrs:{placeholder:"房源类别"},model:{value:t.searchData.sale_type,callback:function(a){t.$set(t.searchData,"sale_type",a)},expression:"searchData.sale_type"}},[e("Option",{attrs:{value:"0"}},[t._v("全部")]),t._v(" "),e("Option",{attrs:{value:"2"}},[t._v("二手房出售")]),t._v(" "),e("Option",{attrs:{value:"1"}},[t._v("二手房出租")]),t._v(" "),e("Option",{attrs:{value:"3"}},[t._v("二手房高端")])],1)],1),t._v(" "),e("Col",{attrs:{lg:2,md:2}},[e("Select",{attrs:{placeholder:"房源状态"},model:{value:t.searchData.house_status,callback:function(a){t.$set(t.searchData,"house_status",a)},expression:"searchData.house_status"}},[e("Option",{attrs:{value:"1"}},[t._v("有效")]),t._v(" "),e("Option",{attrs:{value:"0"}},[t._v("无效")]),t._v(" "),e("Option",{attrs:{value:"2"}},[t._v("其他")]),t._v(" "),e("Option",{attrs:{value:"3"}},[t._v("撤单")]),t._v(" "),e("Option",{attrs:{value:"4"}},[t._v("成交")])],1)],1),t._v(" "),e("Col",{attrs:{lg:2,md:2}},[e("Select",{attrs:{placeholder:"钥匙状态"},model:{value:t.searchData.hk_status,callback:function(a){t.$set(t.searchData,"hk_status",a)},expression:"searchData.hk_status"}},[e("Option",{attrs:{value:"1"}},[t._v("正常")]),t._v(" "),e("Option",{attrs:{value:"4"}},[t._v("失效")])],1)],1)],1),t._v(" "),e("Row",{staticStyle:{"margin-top":"10px"},attrs:{gutter:5}},[e("Col",{attrs:{lg:2,md:2}},[e("Cascader",{attrs:{data:t.settings.alldepartlist,value:t.searchData.departpath,"change-on-select":"",transfer:!0},on:{"update:value":function(a){return t.$set(t.searchData,"departpath",a)},"on-change":t.changeDepart},model:{value:t.searchData.departpath,callback:function(a){t.$set(t.searchData,"departpath",a)},expression:"searchData.departpath"}})],1),t._v(" "),e("Col",{attrs:{lg:2,md:2}},[e("Select",{attrs:{placeholder:"",transfer:!0},model:{value:t.searchData.u_id,callback:function(a){t.$set(t.searchData,"u_id",a)},expression:"searchData.u_id"}},t._l(t.users,function(a){return e("Option",{key:a.u_id,attrs:{value:a.u_id}},[t._v(t._s(a.u_name))])}),1)],1),t._v(" "),e("Col",{attrs:{lg:3,md:3}},[e("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"daterange",value:t.searchData.daterange,format:"yyyy-MM-dd",placeholder:"选择时间段",transfer:!0},on:{"on-change":t.selectDate}})],1),t._v(" "),e("Col",{attrs:{lg:2,md:2}},[e("Cascader",{attrs:{data:t.settings.villages,placeholder:"区域选择"},model:{value:t.searchData.villages,callback:function(a){t.$set(t.searchData,"villages",a)},expression:"searchData.villages"}})],1),t._v(" "),e("Col",{attrs:{lg:2,md:2}},[e("Input",{attrs:{placeholder:"单元、房号"},model:{value:t.searchData.danyuan,callback:function(a){t.$set(t.searchData,"danyuan",a)},expression:"searchData.danyuan"}})],1),t._v(" "),e("Col",{attrs:{lg:3,md:3}},[e("Button",{attrs:{type:"primary"},on:{click:t.doSearch}},[t._v("查询")]),t._v(" "),e("Button",{attrs:{type:"primary"},on:{click:t.doClear}},[t._v("清空")])],1)],1),t._v(" "),e("Row",{staticStyle:{"margin-top":"10px"},attrs:{gutter:5}},[e("Col",{attrs:{lg:24,md:24}},[e("RadioGroup",{on:{"on-change":t.daikan_s},model:{value:t.daikan,callback:function(a){t.daikan=a},expression:"daikan"}},[e("Radio",{attrs:{label:"3"}},[t._v("三天有带看")]),t._v(" "),e("Radio",{attrs:{label:"7"}},[t._v("七天有带看")]),t._v(" "),e("Radio",{attrs:{label:"15"}},[t._v("十五天有带看")])],1),t._v(" "),e("RadioGroup",{on:{"on-change":t.genjin_s},model:{value:t.genjin,callback:function(a){t.genjin=a},expression:"genjin"}},[e("Radio",{attrs:{label:"3"}},[t._v("三天有跟进")]),t._v(" "),e("Radio",{attrs:{label:"7"}},[t._v("七天有跟进")]),t._v(" "),e("Radio",{attrs:{label:"15"}},[t._v("十五天有跟进")])],1),t._v(" "),e("Dropdown",{attrs:{trigger:"click"},on:{"on-click":t.paixu}},[e("Button",{attrs:{type:"primary"}},[e("a",{staticStyle:{color:"#fff"},attrs:{href:"javascript:void(0)"}},[t._v(" 条件排序\n                        "),e("Icon",{attrs:{type:"arrow-down-b"}})],1)]),t._v(" "),e("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[e("DropdownItem",{attrs:{name:"1"}},[t._v("按跟进次数升序")]),t._v(" "),e("DropdownItem",{attrs:{name:"2"}},[t._v("按跟进次数降序")]),t._v(" "),e("DropdownItem",{attrs:{name:"3"}},[t._v("按带看次数升序")]),t._v(" "),e("DropdownItem",{attrs:{name:"4"}},[t._v("按带看次数降序")]),t._v(" "),e("DropdownItem",{attrs:{name:"5"}},[t._v("按录入时间升序")]),t._v(" "),e("DropdownItem",{attrs:{name:"6"}},[t._v("按录入时间降序")])],1)],1)],1)],1)],1)],1),t._v(" "),e("Col",{staticClass:"marTop10px",attrs:{lg:24,md:24}},[e("Card",[e("Table",{attrs:{border:"",columns:t.chColumns,data:t.chData}}),t._v(" "),e("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[e("div",{staticStyle:{float:"right"}},[e("Page",{attrs:{total:t.pageCount,current:t.page,"show-total":!0,"page-size":t.pageSize},on:{"on-change":t.changePage}})],1)])],1),t._v(" "),e("Modal",{attrs:{title:"查看房源钥匙日志","mask-closable":!1,width:"640"},model:{value:t.rizhi,callback:function(a){t.rizhi=a},expression:"rizhi"}},[e("div",{attrs:{slot:"header"},slot:"header"},[e("a",{staticClass:"ivu-modal-close",staticStyle:{display:"block!important"},on:{click:function(a){t.rizhi=!1}}},[e("i",{staticClass:"ivu-icon ivu-icon-ios-close-empty"})]),t._v(" "),e("div",{staticClass:"ivu-modal-header-inner"},[t._v("查看房源钥匙日志")])]),t._v(" "),e("Table",{attrs:{columns:t.keylogColumns,data:t.keylogdata,border:"",script:"",height:"360"}})],1),t._v(" "),e("Modal",{attrs:{title:"钥匙借出","mask-closable":!1},model:{value:t.jiechu,callback:function(a){t.jiechu=a},expression:"jiechu"}},[e("div",{attrs:{slot:"header"},slot:"header"},[e("a",{staticClass:"ivu-modal-close",staticStyle:{display:"block!important"},on:{click:t.JiechuModalCancel}},[e("i",{staticClass:"ivu-icon ivu-icon-ios-close-empty"})]),t._v(" "),e("div",{staticClass:"ivu-modal-header-inner"},[t._v("钥匙借出")])]),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"text",size:"large"},on:{click:t.JiechuModalCancel}},[t._v("取消")]),t._v(" "),e("Button",{attrs:{type:"primary",size:"large"},on:{click:t.JiechuModalOk}},[t._v("确定")])],1),t._v(" "),e("Form",{ref:"jiechuData",attrs:{model:t.jiechuData,rules:t.jiechuValidate,"label-width":80}},[e("Row",[e("Col",{attrs:{lg:12,md:12}},[e("FormItem",{attrs:{label:"部门选择",prop:"departpathss"}},[e("Cascader",{attrs:{data:t.settings.alldepartlist,value:t.jiechuData.departpathss,"change-on-select":"",transfer:!0},on:{"on-change":t.changeJiechuDepart}})],1)],1),t._v(" "),e("Col",{attrs:{lg:12,md:12}},[e("FormItem",{attrs:{label:"钥匙借出人",prop:"hk_jiechuyaoshiren"}},[e("Select",{attrs:{placeholder:"",transfer:!0},model:{value:t.jiechuData.hk_jiechuyaoshiren,callback:function(a){t.$set(t.jiechuData,"hk_jiechuyaoshiren",a)},expression:"jiechuData.hk_jiechuyaoshiren"}},t._l(t.jiechu_users,function(a){return e("Option",{key:a.u_id,attrs:{value:a.u_id}},[t._v(t._s(a.u_name))])}),1)],1)],1)],1)],1)],1),t._v(" "),e("Modal",{attrs:{title:"失效","mask-closable":!1},model:{value:t.shixiao,callback:function(a){t.shixiao=a},expression:"shixiao"}},[e("div",{attrs:{slot:"header"},slot:"header"},[e("a",{staticClass:"ivu-modal-close",staticStyle:{display:"block!important"},on:{click:t.shixiaoModalCancel}},[e("i",{staticClass:"ivu-icon ivu-icon-ios-close-empty"})]),t._v(" "),e("div",{staticClass:"ivu-modal-header-inner"},[t._v("失效")])]),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"text",size:"large"},on:{click:t.shixiaoModalCancel}},[t._v("取消")]),t._v(" "),e("Button",{attrs:{type:"primary",size:"large"},on:{click:t.shixiaoModalOk}},[t._v("确定")])],1),t._v(" "),e("Form",{ref:"shixiaoData",attrs:{model:t.shixiaoData,rules:t.shixiaoValidate,"label-width":80}},[e("Row",[e("Col",{attrs:{lg:12,md:12}},[e("FormItem",{attrs:{label:"失效原因",prop:"shixiaoyuanyin"}},[e("Select",{attrs:{placeholder:"失效原因",transfer:!0},model:{value:t.shixiaoData.shixiaoyuanyin,callback:function(a){t.$set(t.shixiaoData,"shixiaoyuanyin",a)},expression:"shixiaoData.shixiaoyuanyin"}},t._l(t.settings.shixiaoyuanyin,function(a){return e("Option",{key:a,attrs:{value:a}},[t._v(t._s(a))])}),1)],1)],1)],1),t._v(" "),e("Row",[e("Col",{attrs:{lg:24,md:24}},[e("FormItem",{attrs:{label:"备注",prop:"shixiaoBeizhu"}},[e("Input",{attrs:{type:"textarea",rows:4,placeholder:"请输入失效备注"},model:{value:t.shixiaoData.shixiaoBeizhu,callback:function(a){t.$set(t.shixiaoData,"shixiaoBeizhu",a)},expression:"shixiaoData.shixiaoBeizhu"}})],1)],1)],1)],1)],1)],1)],1)},i=[];s._withStripped=!0;var n={render:s,staticRenderFns:i};a.default=n}});