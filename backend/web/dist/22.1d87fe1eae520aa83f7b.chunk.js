webpackJsonp([22],{233:function(n,e,t){"use strict";function a(n){c||(t(537),t(539))}Object.defineProperty(e,"__esModule",{value:!0});var s=t(450),o=t.n(s);for(var r in s)"default"!==r&&function(n){t.d(e,n,function(){return s[n]})}(r);var i=t(541),l=t.n(i),c=!1,d=t(0),m=a,p=d(o.a,l.a,!1,m,null,null);p.options.__file="src/views/login.vue",e.default=p.exports},450:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=t(9),s=function(n){return n&&n.__esModule?n:{default:n}}(a);e.default={data:function(){var n=this,e=function(e,t,a){t!==n.companyRegisterForm.password?a(new Error("两次输入密码不一致!")):a()};return{form:{companyId:"",userName:"",password:""},rules:{companyId:[{required:!0,message:"公司号不能为空",trigger:"blur"}],userName:[{required:!0,message:"账号不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]},companyRegister:!1,companyRegisterForm:{name:"",mobile:"",password:"",repassword:"",recommend_code:"",code:""},companyRegisterValidate:{name:[{required:!0,message:"请填写公司名称",trigger:"blur"}],mobile:[{required:!0,message:"请填写公司负责人手机号",trigger:"blur"},{validator:function(n,e,t){/^1[345789]\d{9}$/.test(e)||t(new Error("请输入正确的手机号码")),t()},trigger:"blur"}],password:[{required:!0,message:"请填写登录密码",trigger:"blur"},{type:"string",min:6,max:10,message:"登录密码长度6-10位",trigger:"blur"}],repassword:[{required:!0,message:"请再次填写登录密码",trigger:"blur"},{validator:e,trigger:"blur"}],code:[{required:!0,message:"请填写短信验证码",trigger:"blur"}]},sendtext:"发送验证码",waittime:60,license:!1,is_license:!0,licenseData:{},licenseValidate:{mendian:[{required:!0,message:"门店不能为空",trigger:"blur"}],shenqingren:[{required:!0,message:"申请人不能为空",trigger:"blur"}],remake:[{required:!0,message:"说明不能为空",trigger:"blur"}]}}},created:function(){var n=window.localStorage.getItem("companyID",this.form.companyId);n&&this.$set(this.form,"companyId",n)},methods:{noclick:function(){return!1},showCompany:function(){this.companyRegister=!0},companyRegisterCancel:function(){this.companyRegister=!1,this.$refs.companyRegisterForm.resetFields()},companyRegisterOk:function(){var n=this;this.$refs.companyRegisterForm.validate(function(e){e&&n.$http.post(api_param.apiurl+"company/register",{name:n.companyRegisterForm.name,phone:n.companyRegisterForm.mobile,password:n.companyRegisterForm.password,recommend_code:n.companyRegisterForm.recommend_code,code:n.companyRegisterForm.code},{emulateJSON:!0}).then(function(n){200==n.data.code?(this.companyRegister=!1,this.$refs.companyRegisterForm.resetFields(),this.$Notice.success({title:"开户成功通知",desc:n.data.data.content}),this.$set(this.form,"companyId",n.data.data.companyid)):this.$Message.warning(n.data.message)},function(n){console.log(n)})})},sendMessage:function(){this.$http.post(api_param.apiurl+"company/sendsms",{phone:this.companyRegisterForm.mobile},{emulateJSON:!0}).then(function(n){"200"==n.data.code?this.time():this.$Message.warning(n.data.message)},function(n){console.log(n)})},time:function(){if(0==this.waittime)this.sendtext="发送验证码",this.waittime=60;else{this.sendtext="重新发送("+this.waittime+")",this.waittime=this.waittime-1;var n=this;setTimeout(function(){n.time()},1e3)}},handleSubmit:function(){var n=this;this.$refs.loginForm.validate(function(e){e&&n.$http.post(api_param.apiurl+"login/login",{cid:n.form.companyId,account:n.form.userName,password:n.form.password},{emulateJSON:!0}).then(function(n){"200"==n.data.code?(this.$Message.success(n.data.message),s.default.set("user",n.data.data.u_name),s.default.set("u_mobile",n.data.data.u_phone),s.default.set("companyid",n.data.data.company_id),s.default.set("dts_id",n.data.data.dts_id),s.default.set("area_id",n.data.data.area_id),s.default.set("area",n.data.data.area_name),s.default.set("district",n.data.data.dts_name),s.default.set("uid",n.data.data.u_id),s.default.set("u_dept_id",n.data.data.u_dept_id),s.default.set("dept_name",n.data.data.d_name),s.default.set("role_type",n.data.data.role_type),this.$store.commit("clearAllTags"),this.$store.commit("setAvator","https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=3448484253,3685836170&fm=27&gp=0.jpg"),api_param.XAccessToken=n.data.data.tokens,window.localStorage.setItem("userTokens",n.data.data.tokens),window.localStorage.setItem("companyID",this.form.companyId),this.$store.commit("addMenulist",n.data.data.menu),this.$router.push({name:"home_index"})):this.$Message.warning(n.data.message)},function(n){console.log(n)})})},getLicense:function(){var n=this.getCode();if(!n)return this.$Message.error("获取机器码失败，请使用客户端登录系统！"),!1;this.$http.post(api_param.apiurl+"login/getlicense",{code:n},{emulateJSON:!0}).then(function(n){"200"==n.data.code?this.is_license=!0:(this.license=!0,this.$Message.warning(n.data.message))},function(n){console.log(n)})},getCode:function(){var n="";try{n=window.HTMLPackHelper.machineCode}catch(n){return!1}return n},ModalOk:function(){var n=this;this.$refs.licenseData.validate(function(e){e&&(n.licenseData.code=n.getCode(),n.$http.post(api_param.apiurl+"login/setlicense",n.licenseData,{emulateJSON:!0}).then(function(n){"200"==n.data.code?(this.license=!1,this.$Message.success(n.data.message)):(this.license=!0,this.$Message.warning(n.data.message))},function(n){console.log(n)}))})}}}},537:function(n,e,t){var a=t(538);"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t(8)("449b86e6",a,!1,{})},538:function(n,e,t){e=n.exports=t(7)(!1),e.push([n.i,"\n.login {\n  width: 100%;\n  height: 100%;\n  background-image: url('/src/images/login.png');\n  background-size: cover;\n  background-position: center;\n  position: relative;\n}\n.login-con {\n  position: absolute;\n  right: 320px;\n  top: 50%;\n  transform: translateY(-60%);\n  width: 366px;\n}\n.login-con-header {\n  font-size: 16px;\n  font-weight: 300;\n  text-align: center;\n  padding: 30px 0;\n}\n.login-con .form-con {\n  padding: 16px 16px;\n}\n.login-con .login-tip {\n  font-size: 10px;\n  text-align: center;\n  color: #c3c3c3;\n}\n.login-con .register {\n  font-size: 12px;\n  text-align: right;\n  color: #999 !important;\n  margin: 15px 0;\n  cursor: pointer;\n}\n.login-con .register a {\n  font-size: 12px;\n  text-align: right;\n  color: #2d8cf0;\n  padding: 15px 0;\n}\n",""])},539:function(n,e,t){var a=t(540);"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t(8)("9751b152",a,!1,{})},540:function(n,e,t){e=n.exports=t(7)(!1),e.push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},541:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"login",on:{keydown:function(e){return!e.type.indexOf("key")&&n._k(e.keyCode,"enter",13,e.key,"Enter")?null:n.handleSubmit(e)},contextmenu:n.noclick}},[n.is_license?t("div",{staticClass:"login-con"},[t("Card",{attrs:{bordered:!1}},[t("p",{attrs:{slot:"title"},slot:"title"},[t("Icon",{attrs:{type:"log-in"}}),n._v("\n                欢迎登录\n            ")],1),n._v(" "),t("div",{staticClass:"form-con"},[t("Form",{ref:"loginForm",attrs:{model:n.form,rules:n.rules}},[t("FormItem",{attrs:{prop:"companyId"}},[t("Input",{attrs:{placeholder:"请输入公司号"},model:{value:n.form.companyId,callback:function(e){n.$set(n.form,"companyId",e)},expression:"form.companyId"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("Icon",{attrs:{size:16,type:"person"}})],1)])],1),n._v(" "),t("FormItem",{attrs:{prop:"userName"}},[t("Input",{attrs:{placeholder:"请输入用户名"},model:{value:n.form.userName,callback:function(e){n.$set(n.form,"userName",e)},expression:"form.userName"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("Icon",{attrs:{size:16,type:"person"}})],1)])],1),n._v(" "),t("FormItem",{attrs:{prop:"password"}},[t("Input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:n.form.password,callback:function(e){n.$set(n.form,"password",e)},expression:"form.password"}},[t("span",{attrs:{slot:"prepend"},slot:"prepend"},[t("Icon",{attrs:{size:14,type:"locked"}})],1)])],1),n._v(" "),t("FormItem",{staticStyle:{"margin-bottom":"0 !important"}},[t("Button",{attrs:{type:"primary",long:""},on:{click:n.handleSubmit}},[n._v("登录")])],1)],1),n._v(" "),t("p",{staticClass:"register",on:{click:n.showCompany}},[n._v("还没有注册吗？"),t("a",{staticStyle:{"text-decoration":"none"}},[n._v("公司开户")])]),n._v(" "),t("p",{staticClass:"login-tip"},[n._v("客户服务电话:173-5113-1096")])],1)])],1):n._e(),n._v(" "),t("Modal",{attrs:{title:"申请授权",rules:n.licenseValidate,closable:!1,"mask-closable":!1,width:500},model:{value:n.license,callback:function(e){n.license=e},expression:"license"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"ivu-modal-header-inner"},[n._v("申请授权")])]),n._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"primary",size:"large"},on:{click:n.ModalOk}},[n._v("确定")])],1),n._v(" "),t("Form",{ref:"licenseData",attrs:{model:n.licenseData,rules:n.licenseValidate,"label-width":80}},[t("Row",[t("Col",{attrs:{lg:24,md:24}},[t("FormItem",{attrs:{label:"申请门店",prop:"mendian"}},[t("Input",{attrs:{placeholder:"申请门店"},model:{value:n.licenseData.mendian,callback:function(e){n.$set(n.licenseData,"mendian",e)},expression:"licenseData.mendian"}})],1)],1)],1),n._v(" "),t("Row",[t("Col",{attrs:{lg:24,md:24}},[t("FormItem",{attrs:{label:"申请人",prop:"shenqingren"}},[t("Input",{attrs:{placeholder:"申请人"},model:{value:n.licenseData.shenqingren,callback:function(e){n.$set(n.licenseData,"shenqingren",e)},expression:"licenseData.shenqingren"}})],1)],1)],1),n._v(" "),t("Row",[t("Col",{attrs:{lg:24,md:24}},[t("FormItem",{attrs:{label:"说明",prop:"remake"}},[t("Input",{attrs:{type:"textarea",rows:4,placeholder:"说明"},model:{value:n.licenseData.remake,callback:function(e){n.$set(n.licenseData,"remake",e)},expression:"licenseData.remake"}})],1)],1)],1)],1)],1),n._v(" "),t("Modal",{attrs:{title:"公司开户",closable:!0,"mask-closable":!1,width:400},model:{value:n.companyRegister,callback:function(e){n.companyRegister=e},expression:"companyRegister"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("div",{staticClass:"ivu-modal-header-inner"},[n._v("公司开户")])]),n._v(" "),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{size:"large"},on:{click:n.companyRegisterCancel}},[n._v("取消")]),n._v(" "),t("Button",{attrs:{type:"primary",size:"large"},on:{click:n.companyRegisterOk}},[n._v("确定")])],1),n._v(" "),t("Form",{ref:"companyRegisterForm",attrs:{model:n.companyRegisterForm,rules:n.companyRegisterValidate,"label-width":80}},[t("Row",[t("Col",{attrs:{lg:22,md:22}},[t("FormItem",{attrs:{label:"公司名称",prop:"name"}},[t("Input",{attrs:{placeholder:"公司全称"},model:{value:n.companyRegisterForm.name,callback:function(e){n.$set(n.companyRegisterForm,"name",e)},expression:"companyRegisterForm.name"}})],1)],1)],1),n._v(" "),t("Row",[t("Col",{attrs:{lg:22,md:22}},[t("FormItem",{attrs:{label:"联系电话",prop:"mobile"}},[t("Input",{attrs:{placeholder:"公司负责人手机号"},model:{value:n.companyRegisterForm.mobile,callback:function(e){n.$set(n.companyRegisterForm,"mobile",e)},expression:"companyRegisterForm.mobile"}})],1)],1)],1),n._v(" "),t("Row",[t("Col",{attrs:{lg:22,md:22}},[t("FormItem",{attrs:{label:"登录密码",prop:"password"}},[t("Input",{attrs:{type:"password",placeholder:"登录密码"},model:{value:n.companyRegisterForm.password,callback:function(e){n.$set(n.companyRegisterForm,"password",e)},expression:"companyRegisterForm.password"}})],1)],1)],1),n._v(" "),t("Row",[t("Col",{attrs:{lg:22,md:22}},[t("FormItem",{attrs:{label:"确认密码",prop:"repassword"}},[t("Input",{attrs:{type:"password",placeholder:"确认登录密码"},model:{value:n.companyRegisterForm.repassword,callback:function(e){n.$set(n.companyRegisterForm,"repassword",e)},expression:"companyRegisterForm.repassword"}})],1)],1)],1),n._v(" "),t("Row",[t("Col",{attrs:{lg:22,md:22}},[t("FormItem",{attrs:{label:"推荐码",prop:"recommend_code"}},[t("Input",{attrs:{type:"text",placeholder:"推荐码"},model:{value:n.companyRegisterForm.recommend_code,callback:function(e){n.$set(n.companyRegisterForm,"recommend_code",e)},expression:"companyRegisterForm.recommend_code"}})],1)],1)],1),n._v(" "),t("Row",[t("Col",{attrs:{lg:22,md:22}},[t("FormItem",{attrs:{label:"验证码",prop:"code"}},[t("Row",[t("Col",{attrs:{span:"12"}},[t("Input",{attrs:{type:"text",placeholder:"验证码"},model:{value:n.companyRegisterForm.code,callback:function(e){n.$set(n.companyRegisterForm,"code",e)},expression:"companyRegisterForm.code"}})],1),n._v(" "),60==n.waittime?t("Col",{attrs:{span:"10",offset:"1"}},[t("Button",{attrs:{type:"info"},on:{click:n.sendMessage}},[n._v(n._s(n.sendtext))])],1):t("Col",{attrs:{span:"10",offset:"1"}},[t("Button",{attrs:{type:"info",disabled:""}},[n._v(n._s(n.sendtext))])],1)],1)],1)],1)],1)],1)],1)],1)},s=[];a._withStripped=!0;var o={render:a,staticRenderFns:s};e.default=o}});