webpackJsonp([28],{261:function(e,t,a){"use strict";function n(e){l||a(687)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(496),r=a.n(i);for(var s in i)"default"!==s&&function(e){a.d(t,e,function(){return i[e]})}(s);var o=a(689),c=a.n(o),l=!1,g=a(0),u=n,h=g(r.a,c.a,!1,u,null,null);h.options.__file="src/views/ziyuanguanli/ky-genjin.vue",t.default=h.exports},496:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"kyGenjin",data:function(){var e=this;return{genjinjilv:!1,pageTotal:0,pageCurrent:1,pageSize:10,FPpageTotal:0,FPpageCurrent:1,FPpageSize:10,settings:[],genjinfangshi:[[]],mDaterange:[],searchDaterange:[],searchData:{u_id:"",c_type:"",genjinfangshi:"",keywd:""},departpath:[],users:[],selcustId:"",peizhi:[],genjinColumns:[{title:"类型",key:"customer_type",align:"center",render:function(e,t){var a=t.row.customer_type,n="";if("0"==a)n="买卖客源";else if("1"==a)n="租赁客源";else{if("2"!=a)return"未知客源";n="高端客源"}return e("div",{props:{}},n)}},{title:"跟进时间",key:"ctime",align:"center"},{title:"跟单方式",key:"genjinfangshi",align:"center"},{title:"客源编号",key:"xuqiubianhao",align:"center",render:function(t,a){return t("div",[t("a",{props:{type:"warning",size:"small"},style:{textDecoration:"underline"},domProps:{innerHTML:a.row.xuqiubianhao},on:{click:function(){var t={customer_uuid:a.row.customer_uuid,customer_type:a.row.customer_type};e.$router.push({name:"customerEtails",params:t})}}})])}},{title:"跟进人",key:"genjinren",align:"center"},{title:"部门",key:"bumen",align:"center"},{title:"跟进内容",key:"genjinneirong",align:"center"},{title:"操作",key:"action",width:150,align:"center",render:function(t,a){return t("div",[t("a",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.selcustId=a.row.customer_uuid,e.genjinjilv=!0,e.getFollowup()}}},"查看所有跟进")])}}],genjinData:[{genleixing:"客源出售",gentime:"2018-7-20 14:53",genfangshi:"电话跟进",gennum:"CSFY-1807-0025",genmen:"徐晓月",genbumen:"金筑店",genneirong:"正常电话回访"}],listColumns:[{title:"跟进时间",key:"ctime",align:"center",width:120},{title:"跟进方式",key:"genjinfangshi",align:"center"},{title:"跟进人",key:"genjinren",align:"center"},{title:"部门",key:"bumen",align:"center"},{title:"跟进内容",key:"genjinneirong",align:"center",width:200}],listData:[]}},created:function(){this.getSetting(),this.getPeizhi(),this.getIndex()},methods:{changeSearchDepart:function(e,t){this.departpath=e;var a=e[e.length-1];this.users=this.peizhi.users[a]},getSetting:function(){this.$http.get(api_param.apiurl+"customer_follow/getsetting",{params:{},headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(e){200==e.data.code?this.genjinfangshi=e.data.data.genjinfangshi:401==e.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(e.data.message)},function(e){this.$Message.error("你的网络开小差了^—^")})},changePage:function(e){this.pageCurrent=e,this.getIndex()},changeFPPage:function(e){this.FPpageCurrent=e,this.getFollowup()},doSearch:function(){this.pageCurrent=1,this.getIndex()},clearSearch:function(){for(var e in this.searchData)this.$set(this.searchData,e,"");this.searchDaterange=[],this.mDaterange=[],this.getIndex()},changeDaterange:function(e){this.searchDaterange=e},clearDaterange:function(e){this.searchDaterange=[]},getIndex:function(){var e=this.searchData;e.page=this.pageCurrent,e.dateRange=this.searchDaterange,this.$http.post(api_param.apiurl+"customer_follow/index",e,{emulateJSON:!0,headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(e){200==e.data.code?(this.genjinData=e.data.data.list,this.pageTotal=parseInt(e.data.data.count)):401==e.data.code?(this.$Message.error("登录超时"),this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(e.data.message)},function(e){this.$Message.error("网络异常")})},getPeizhi:function(){var e={page:1,customer_type:0};this.$http.get(api_param.apiurl+"/customer/index",{params:e,headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(e){200==e.data.code?0==this.peizhi.length&&(this.peizhi=e.data.data.peizhi):401==e.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(e.data.message)},function(e){})},getFollowup:function(){this.$http.post(api_param.apiurl+"customer_follow/index",{customer_uuid:this.selcustId,page:this.FPpageCurrent},{emulateJSON:!0,headers:{"X-Access-Token":api_param.XAccessToken}}).then(function(e){200==e.data.code?(this.listData=e.data.data.list,this.FPpageTotal=parseInt(e.data.data.count)):401==e.data.code?(this.$store.commit("logout",this),this.$store.commit("clearOpenedSubmenu"),this.$router.push({name:"login"})):this.$Message.warning(e.data.message)},function(e){this.$Message.error("网络异常")})}}}},687:function(e,t,a){var n=a(688);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a(8)("70fd85b6",n,!1,{})},688:function(e,t,a){t=e.exports=a(7)(!1),t.push([e.i,"",""])},689:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Row",[a("Col",{attrs:{lg:24}},[a("Card",[a("Row",{attrs:{gutter:5}},[a("Col",{attrs:{lg:2}},[a("Select",{attrs:{placeholder:"客源类型",transfer:!0},model:{value:e.searchData.c_type,callback:function(t){e.$set(e.searchData,"c_type",t)},expression:"searchData.c_type"}},[a("Option",{attrs:{value:"0"}},[e._v("买卖客源")]),e._v(" "),a("Option",{attrs:{value:"1"}},[e._v("租赁客源")]),e._v(" "),a("Option",{attrs:{value:"2"}},[e._v("高端客源")])],1)],1),e._v(" "),a("Col",{attrs:{lg:2}},[a("Select",{attrs:{placeholder:"跟单方式"},model:{value:e.searchData.genjinfangshi,callback:function(t){e.$set(e.searchData,"genjinfangshi",t)},expression:"searchData.genjinfangshi"}},e._l(JSON.parse(this.genjinfangshi[0].base_desp),function(t){return a("Option",{key:t.child_name,attrs:{value:t.child_name}},[e._v(e._s(t.child_name))])}),1)],1),e._v(" "),a("Col",{attrs:{lg:2}},[a("Cascader",{attrs:{data:this.peizhi.benzu,trigger:"click",filterable:"","change-on-select":"",placeholder:"部门选择"},on:{"on-change":e.changeSearchDepart},model:{value:e.searchData.departpath,callback:function(t){e.$set(e.searchData,"departpath",t)},expression:"searchData.departpath"}})],1),e._v(" "),a("Col",{attrs:{lg:2}},[a("Select",{attrs:{placeholder:"跟进人",transfer:!0},model:{value:e.searchData.u_id,callback:function(t){e.$set(e.searchData,"u_id",t)},expression:"searchData.u_id"}},e._l(e.users,function(t){return a("Option",{key:t.u_id,attrs:{value:t.u_id}},[e._v(e._s(t.u_name))])}),1)],1),e._v(" "),a("Col",{attrs:{lg:3}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"daterange",placement:"bottom-end",placeholder:"开始-截止日期"},on:{"on-change":e.changeDaterange,"on-clear":e.clearDaterange},model:{value:e.mDaterange,callback:function(t){e.mDaterange=t},expression:"mDaterange"}})],1),e._v(" "),a("Col",{attrs:{lg:3}},[a("Input",{attrs:{placeholder:"客源编号、跟进内容"},model:{value:e.searchData.keywd,callback:function(t){e.$set(e.searchData,"keywd",t)},expression:"searchData.keywd"}})],1),e._v(" "),a("Col",{attrs:{lg:3}},[a("Button",{attrs:{type:"primary"},on:{click:e.doSearch}},[e._v("查询")]),e._v(" "),a("Button",{attrs:{type:"primary"},on:{click:e.clearSearch}},[e._v("清空")])],1)],1)],1)],1),e._v(" "),a("Col",{staticStyle:{"margin-top":"10px"},attrs:{lg:24,md:24}},[a("Card",[a("Row",[a("Table",{attrs:{border:"",columns:e.genjinColumns,data:e.genjinData}}),e._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.pageTotal,current:e.pageCurrent,"show-total":"","page-size":e.pageSize},on:{"on-change":e.changePage}})],1)])],1)],1)],1),e._v(" "),a("Modal",{attrs:{title:"客源跟进记录",width:"640"},model:{value:e.genjinjilv,callback:function(t){e.genjinjilv=t},expression:"genjinjilv"}},[a("Row",[a("Col",[a("Table",{attrs:{border:"",columns:e.listColumns,data:e.listData}}),e._v(" "),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{total:e.FPpageTotal,current:e.FPpageCurrent,"show-total":"","page-size":e.FPpageSize},on:{"on-change":e.changeFPPage}})],1)])],1)],1)],1)],1)},i=[];n._withStripped=!0;var r={render:n,staticRenderFns:i};t.default=r}});